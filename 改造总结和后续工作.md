# AI Japan é¡¹ç›®æ”¹é€ æ€»ç»“å’Œåç»­å·¥ä½œ

**æ—¥æœŸï¼š** 2025-01-XX

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é…ç½®ç®¡ç†æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/config/__init__.py`
- `src/config/config_manager.py`

**åŠŸèƒ½ï¼š**
- å•ä¾‹æ¨¡å¼çš„é…ç½®ç®¡ç†å™¨
- ç»Ÿä¸€è¯»å– `config/client_config.json`
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- æä¾›ä¾¿æ·çš„é…ç½®è®¿é—®æ–¹æ³•

### 2. APIå®¢æˆ·ç«¯æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/api_client.py`

**åŠŸèƒ½ï¼š**
- ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼Œé—´éš”2ç§’ï¼‰
- æ”¯æŒå¹²è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨è¡¥å……å…ƒæ•°æ®ï¼ˆbatch_id, pool_idï¼‰
- ä½¿ç”¨æœåŠ¡ç«¯æ ‡å‡†æ¥å£

**å·²å®ç°çš„æ¥å£ï¼š**
- `send_sensor_data()` - ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ 
- `send_feeder_data()` - å–‚é£Ÿæœºæ•°æ®ä¸Šä¼ 
- `send_operation_data()` - æ“ä½œæ—¥å¿—ä¸Šä¼ 
- `send_camera_image()` - æ‘„åƒå¤´å›¾åƒä¸Šä¼ 
- `send_camera_status()` - æ‘„åƒå¤´çŠ¶æ€ä¸ŠæŠ¥

### 3. ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼‰âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/sensor_data_service_v2.py`

**æ”¹è¿›ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—
- ä»é…ç½®æ–‡ä»¶è¯»å–ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨
- å®æ—¶ä¸Šä¼ æ•°æ®åˆ°æœåŠ¡ç«¯ï¼ˆä½¿ç”¨æ ‡å‡†æ¥å£ï¼‰
- è‡ªåŠ¨è¡¥å……å®Œæ•´å…ƒæ•°æ®

### 4. APIæ¥å£æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `docs/APIæ¥å£æ–‡æ¡£.md`

**å†…å®¹ï¼š**
- å®Œæ•´çš„æ¥å£è¯´æ˜
- è¯·æ±‚/å“åº”æ ¼å¼
- å­—æ®µè¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹
- é”™è¯¯å¤„ç†

### 5. æ”¹é€ è¯´æ˜æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `README_æ”¹é€ è¯´æ˜.md`

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### å®¢æˆ·ç«¯æ”¹é€ 

#### 1. æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/sensor_data_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- å°† `from src.config import get_config` æ”¹ä¸ºä½¿ç”¨æ–°çš„ `config_manager`
- æ·»åŠ æ•°æ®ä¸Šä¼ åŠŸèƒ½ï¼ˆè°ƒç”¨ `api_client.send_sensor_data()`ï¼‰
- ç¡®ä¿ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨

**å»ºè®®ï¼š** å¯ä»¥ç›´æ¥ä½¿ç”¨ `sensor_data_service_v2.py` æ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼Œæˆ–é€æ­¥è¿ç§»ã€‚

#### 2. æ”¹é€ æ‘„åƒå¤´æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/camera_controller_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `config_manager` è¯»å–æ‘„åƒå¤´é…ç½®
- ä½¿ç”¨ `api_client.send_camera_image()` ä¸Šä¼ å›¾åƒ
- è¡¥å……å®Œæ•´å…ƒæ•°æ®ï¼ˆbatch_id, pool_id, width_px, height_pxç­‰ï¼‰
- ä»é…ç½®è¯»å–æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨

#### 3. æ”¹é€ å–‚é£ŸæœºæœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/feeder_service.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_schedule_task.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_status_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- åœ¨å–‚é£Ÿæ“ä½œåè°ƒç”¨ `api_client.send_feeder_data()` è®°å½•æ•°æ®
- ä»é…ç½®è¯»å–å–‚é£Ÿæœºé…ç½®ï¼ˆdevice_id, pool_id, batch_idç­‰ï¼‰
- å®ç°æ•°æ®è®°å½•å’Œä¸Šä¼ åŠŸèƒ½

#### 4. æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

**æ–‡ä»¶ï¼š** `src/app/main.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨æ–°çš„é…ç½®ç®¡ç†æ¨¡å—
- ä½¿ç”¨æ–°çš„æœåŠ¡ç‰ˆæœ¬ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
- ç»Ÿä¸€ä»»åŠ¡æ³¨å†Œæ–¹å¼

#### 5. æ›´æ–°ä¼ æ„Ÿå™¨æ•°æ®æµå¼ä¸Šä¼ ä»»åŠ¡

**æ–‡ä»¶ï¼š** `src/tasks/sensor_data_stream_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `api_client.send_sensor_data()` æ›¿ä»£ç›´æ¥HTTPè¯·æ±‚
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—

#### 6. æ›´æ–°æ•°æ®ä¸Šä¼ è„šæœ¬

**æ–‡ä»¶ï¼š** `client/updata.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—è¯»å–è·¯å¾„é…ç½®
- ä½¿ç”¨APIå®¢æˆ·ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## âš ï¸ æœåŠ¡ç«¯éœ€è¦æ·»åŠ çš„æ¥å£

### æ‘„åƒå¤´æ•°æ®æ¥æ”¶æ¥å£

**è·¯å¾„ï¼š** `POST /api/data/cameras`

**éœ€è¦åœ¨ `japan_server/routes/data_collection_routes.py` ä¸­æ·»åŠ ï¼š**

```python
@data_collection_bp.route('/cameras', methods=['POST'])
def receive_camera_data():
    """
    æ¥æ”¶æ‘„åƒå¤´å›¾åƒæ•°æ®æ¥å£
    
    è¯·æ±‚æ–¹å¼ï¼šmultipart/form-data
    å‚æ•°ï¼š
    - file: å›¾åƒæ–‡ä»¶ï¼ˆå¿…å¡«ï¼‰
    - camera_id: æ‘„åƒå¤´IDï¼ˆå¿…å¡«ï¼‰
    - batch_id: æ‰¹æ¬¡IDï¼ˆå¯é€‰ï¼‰
    - pool_id: æ± å·ï¼ˆå¯é€‰ï¼‰
    - timestamp: Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
    - width_px: å›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - height_px: å›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - format: å›¾åƒæ ¼å¼ï¼ˆjpg/pngï¼Œå¯é€‰ï¼‰
    """
    try:
        # æ£€æŸ¥æ–‡ä»¶
        if 'file' not in request.files:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘æ–‡ä»¶å‚æ•°"
            }), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({
                "success": False,
                "error": "æ–‡ä»¶åä¸ºç©º"
            }), 400
        
        # è·å–è¡¨å•æ•°æ®
        camera_id = request.form.get('camera_id')
        if not camera_id:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘å¿…å¡«å­—æ®µ: camera_id"
            }), 400
        
        camera_id = int(camera_id)
        batch_id = request.form.get('batch_id')
        pool_id = request.form.get('pool_id')
        timestamp = request.form.get('timestamp')
        width_px = request.form.get('width_px')
        height_px = request.form.get('height_px')
        format_type = request.form.get('format', 'jpg')
        
        # TODO: ä¿å­˜æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨
        # storage_uri = save_to_storage(file, camera_id, ...)
        
        # æ—¶é—´æ ‡å‡†åŒ–
        if timestamp:
            ts_utc, ts_local = DataCleaningService.standardize_time(int(timestamp))
        else:
            ts_utc, ts_local = DataCleaningService.standardize_time(datetime.now())
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        with db_session_factory() as session:
            camera_image = CameraImage(
                camera_id=camera_id,
                batch_id=int(batch_id) if batch_id else None,
                pool_id=pool_id,
                ts_utc=ts_utc,
                ts_local=ts_local,
                storage_uri=storage_uri,  # TODO: å®é™…å­˜å‚¨URI
                width_px=int(width_px) if width_px else None,
                height_px=int(height_px) if height_px else None,
                format=format_type,
                quality_flag='ok',  # TODO: å®ç°è´¨é‡æ£€æµ‹
                checksum=checksum  # TODO: ç”Ÿæˆæ ¡éªŒå’Œ
            )
            session.add(camera_image)
            session.commit()
            
            return jsonify({
                "success": True,
                "data": {
                    "id": camera_image.id,
                    "camera_id": camera_image.camera_id,
                    "storage_uri": camera_image.storage_uri
                },
                "timestamp": int(time.time() * 1000)
            }), 201
            
    except Exception as e:
        logger.error(f"æ‘„åƒå¤´æ•°æ®æ¥æ”¶å¤±è´¥: {str(e)}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ `config/client_config.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

- [x] ç«™ç‚¹ä¿¡æ¯ï¼ˆpool_id, batch_id, location, timezoneï¼‰
- [x] ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨ï¼ˆæ¯ä¸ªè®¾å¤‡çš„å®Œæ•´é…ç½®ï¼‰
- [x] æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨
- [x] å–‚é£Ÿæœºé…ç½®
- [x] APIç«¯ç‚¹é…ç½®
- [x] ä»»åŠ¡è°ƒåº¦é…ç½®
- [x] è·¯å¾„é…ç½®
- [x] æ¨¡æ‹Ÿæ¨¡å¼é…ç½®

---

## ğŸ”§ æµ‹è¯•å»ºè®®

### 1. é…ç½®æµ‹è¯•

```python
from src.config.config_manager import config_manager

# æµ‹è¯•é…ç½®è¯»å–
print(f"Pool ID: {config_manager.get_pool_id()}")
print(f"Batch ID: {config_manager.get_batch_id()}")
print(f"API URL: {config_manager.get_api_endpoint('sensor_data')}")
```

### 2. APIå®¢æˆ·ç«¯æµ‹è¯•

```python
from src.services.api_client import api_client

# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ ï¼ˆå¹²è¿è¡Œæ¨¡å¼ï¼‰
api_client.dry_run = True
response = api_client.send_sensor_data(
    sensor_id=1,
    value=25.5,
    metric="temperature",
    unit="Â°C"
)
print(response)
```

### 3. æœåŠ¡ç«¯æ¥å£æµ‹è¯•

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š

```bash
# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®æ¥å£
curl -X POST http://8.216.33.92:5000/api/data/sensors \
  -H "Content-Type: application/json" \
  -d '{
    "sensor_id": 1,
    "value": 25.5,
    "metric": "temperature",
    "unit": "Â°C"
  }'
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç å¯èƒ½ä½¿ç”¨äº†æ—§çš„é…ç½®æ–¹å¼ï¼Œéœ€è¦é€æ­¥è¿ç§»
2. **é”™è¯¯å¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰APIè°ƒç”¨éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šç¡®ä¿å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
4. **æµ‹è¯•è¦†ç›–**ï¼šå»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼š
   - [ ] åœ¨æœåŠ¡ç«¯æ·»åŠ  `/api/data/cameras` æ¥å£
   - [ ] æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡ä½¿ç”¨æ–°é…ç½®å’ŒAPIå®¢æˆ·ç«¯
   - [ ] æµ‹è¯•é…ç½®ç®¡ç†å’ŒAPIå®¢æˆ·ç«¯åŠŸèƒ½

2. **çŸ­æœŸï¼ˆ1-2å¤©ï¼‰**ï¼š
   - [ ] æ”¹é€ æ‘„åƒå¤´æœåŠ¡
   - [ ] æ”¹é€ å–‚é£ŸæœºæœåŠ¡
   - [ ] æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

3. **ä¸­æœŸï¼ˆ1å‘¨ï¼‰**ï¼š
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] æ·»åŠ å•å…ƒæµ‹è¯•
   - [ ] ä¼˜åŒ–æ—¥å¿—è®°å½•
   - [ ] æ€§èƒ½ä¼˜åŒ–

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°ï¼š** 2025-01-XX




**æ—¥æœŸï¼š** 2025-01-XX

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é…ç½®ç®¡ç†æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/config/__init__.py`
- `src/config/config_manager.py`

**åŠŸèƒ½ï¼š**
- å•ä¾‹æ¨¡å¼çš„é…ç½®ç®¡ç†å™¨
- ç»Ÿä¸€è¯»å– `config/client_config.json`
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- æä¾›ä¾¿æ·çš„é…ç½®è®¿é—®æ–¹æ³•

### 2. APIå®¢æˆ·ç«¯æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/api_client.py`

**åŠŸèƒ½ï¼š**
- ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼Œé—´éš”2ç§’ï¼‰
- æ”¯æŒå¹²è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨è¡¥å……å…ƒæ•°æ®ï¼ˆbatch_id, pool_idï¼‰
- ä½¿ç”¨æœåŠ¡ç«¯æ ‡å‡†æ¥å£

**å·²å®ç°çš„æ¥å£ï¼š**
- `send_sensor_data()` - ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ 
- `send_feeder_data()` - å–‚é£Ÿæœºæ•°æ®ä¸Šä¼ 
- `send_operation_data()` - æ“ä½œæ—¥å¿—ä¸Šä¼ 
- `send_camera_image()` - æ‘„åƒå¤´å›¾åƒä¸Šä¼ 
- `send_camera_status()` - æ‘„åƒå¤´çŠ¶æ€ä¸ŠæŠ¥

### 3. ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼‰âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/sensor_data_service_v2.py`

**æ”¹è¿›ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—
- ä»é…ç½®æ–‡ä»¶è¯»å–ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨
- å®æ—¶ä¸Šä¼ æ•°æ®åˆ°æœåŠ¡ç«¯ï¼ˆä½¿ç”¨æ ‡å‡†æ¥å£ï¼‰
- è‡ªåŠ¨è¡¥å……å®Œæ•´å…ƒæ•°æ®

### 4. APIæ¥å£æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `docs/APIæ¥å£æ–‡æ¡£.md`

**å†…å®¹ï¼š**
- å®Œæ•´çš„æ¥å£è¯´æ˜
- è¯·æ±‚/å“åº”æ ¼å¼
- å­—æ®µè¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹
- é”™è¯¯å¤„ç†

### 5. æ”¹é€ è¯´æ˜æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `README_æ”¹é€ è¯´æ˜.md`

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### å®¢æˆ·ç«¯æ”¹é€ 

#### 1. æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/sensor_data_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- å°† `from src.config import get_config` æ”¹ä¸ºä½¿ç”¨æ–°çš„ `config_manager`
- æ·»åŠ æ•°æ®ä¸Šä¼ åŠŸèƒ½ï¼ˆè°ƒç”¨ `api_client.send_sensor_data()`ï¼‰
- ç¡®ä¿ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨

**å»ºè®®ï¼š** å¯ä»¥ç›´æ¥ä½¿ç”¨ `sensor_data_service_v2.py` æ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼Œæˆ–é€æ­¥è¿ç§»ã€‚

#### 2. æ”¹é€ æ‘„åƒå¤´æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/camera_controller_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `config_manager` è¯»å–æ‘„åƒå¤´é…ç½®
- ä½¿ç”¨ `api_client.send_camera_image()` ä¸Šä¼ å›¾åƒ
- è¡¥å……å®Œæ•´å…ƒæ•°æ®ï¼ˆbatch_id, pool_id, width_px, height_pxç­‰ï¼‰
- ä»é…ç½®è¯»å–æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨

#### 3. æ”¹é€ å–‚é£ŸæœºæœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/feeder_service.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_schedule_task.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_status_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- åœ¨å–‚é£Ÿæ“ä½œåè°ƒç”¨ `api_client.send_feeder_data()` è®°å½•æ•°æ®
- ä»é…ç½®è¯»å–å–‚é£Ÿæœºé…ç½®ï¼ˆdevice_id, pool_id, batch_idç­‰ï¼‰
- å®ç°æ•°æ®è®°å½•å’Œä¸Šä¼ åŠŸèƒ½

#### 4. æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

**æ–‡ä»¶ï¼š** `src/app/main.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨æ–°çš„é…ç½®ç®¡ç†æ¨¡å—
- ä½¿ç”¨æ–°çš„æœåŠ¡ç‰ˆæœ¬ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
- ç»Ÿä¸€ä»»åŠ¡æ³¨å†Œæ–¹å¼

#### 5. æ›´æ–°ä¼ æ„Ÿå™¨æ•°æ®æµå¼ä¸Šä¼ ä»»åŠ¡

**æ–‡ä»¶ï¼š** `src/tasks/sensor_data_stream_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `api_client.send_sensor_data()` æ›¿ä»£ç›´æ¥HTTPè¯·æ±‚
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—

#### 6. æ›´æ–°æ•°æ®ä¸Šä¼ è„šæœ¬

**æ–‡ä»¶ï¼š** `client/updata.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—è¯»å–è·¯å¾„é…ç½®
- ä½¿ç”¨APIå®¢æˆ·ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## âš ï¸ æœåŠ¡ç«¯éœ€è¦æ·»åŠ çš„æ¥å£

### æ‘„åƒå¤´æ•°æ®æ¥æ”¶æ¥å£

**è·¯å¾„ï¼š** `POST /api/data/cameras`

**éœ€è¦åœ¨ `japan_server/routes/data_collection_routes.py` ä¸­æ·»åŠ ï¼š**

```python
@data_collection_bp.route('/cameras', methods=['POST'])
def receive_camera_data():
    """
    æ¥æ”¶æ‘„åƒå¤´å›¾åƒæ•°æ®æ¥å£
    
    è¯·æ±‚æ–¹å¼ï¼šmultipart/form-data
    å‚æ•°ï¼š
    - file: å›¾åƒæ–‡ä»¶ï¼ˆå¿…å¡«ï¼‰
    - camera_id: æ‘„åƒå¤´IDï¼ˆå¿…å¡«ï¼‰
    - batch_id: æ‰¹æ¬¡IDï¼ˆå¯é€‰ï¼‰
    - pool_id: æ± å·ï¼ˆå¯é€‰ï¼‰
    - timestamp: Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
    - width_px: å›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - height_px: å›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - format: å›¾åƒæ ¼å¼ï¼ˆjpg/pngï¼Œå¯é€‰ï¼‰
    """
    try:
        # æ£€æŸ¥æ–‡ä»¶
        if 'file' not in request.files:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘æ–‡ä»¶å‚æ•°"
            }), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({
                "success": False,
                "error": "æ–‡ä»¶åä¸ºç©º"
            }), 400
        
        # è·å–è¡¨å•æ•°æ®
        camera_id = request.form.get('camera_id')
        if not camera_id:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘å¿…å¡«å­—æ®µ: camera_id"
            }), 400
        
        camera_id = int(camera_id)
        batch_id = request.form.get('batch_id')
        pool_id = request.form.get('pool_id')
        timestamp = request.form.get('timestamp')
        width_px = request.form.get('width_px')
        height_px = request.form.get('height_px')
        format_type = request.form.get('format', 'jpg')
        
        # TODO: ä¿å­˜æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨
        # storage_uri = save_to_storage(file, camera_id, ...)
        
        # æ—¶é—´æ ‡å‡†åŒ–
        if timestamp:
            ts_utc, ts_local = DataCleaningService.standardize_time(int(timestamp))
        else:
            ts_utc, ts_local = DataCleaningService.standardize_time(datetime.now())
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        with db_session_factory() as session:
            camera_image = CameraImage(
                camera_id=camera_id,
                batch_id=int(batch_id) if batch_id else None,
                pool_id=pool_id,
                ts_utc=ts_utc,
                ts_local=ts_local,
                storage_uri=storage_uri,  # TODO: å®é™…å­˜å‚¨URI
                width_px=int(width_px) if width_px else None,
                height_px=int(height_px) if height_px else None,
                format=format_type,
                quality_flag='ok',  # TODO: å®ç°è´¨é‡æ£€æµ‹
                checksum=checksum  # TODO: ç”Ÿæˆæ ¡éªŒå’Œ
            )
            session.add(camera_image)
            session.commit()
            
            return jsonify({
                "success": True,
                "data": {
                    "id": camera_image.id,
                    "camera_id": camera_image.camera_id,
                    "storage_uri": camera_image.storage_uri
                },
                "timestamp": int(time.time() * 1000)
            }), 201
            
    except Exception as e:
        logger.error(f"æ‘„åƒå¤´æ•°æ®æ¥æ”¶å¤±è´¥: {str(e)}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ `config/client_config.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

- [x] ç«™ç‚¹ä¿¡æ¯ï¼ˆpool_id, batch_id, location, timezoneï¼‰
- [x] ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨ï¼ˆæ¯ä¸ªè®¾å¤‡çš„å®Œæ•´é…ç½®ï¼‰
- [x] æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨
- [x] å–‚é£Ÿæœºé…ç½®
- [x] APIç«¯ç‚¹é…ç½®
- [x] ä»»åŠ¡è°ƒåº¦é…ç½®
- [x] è·¯å¾„é…ç½®
- [x] æ¨¡æ‹Ÿæ¨¡å¼é…ç½®

---

## ğŸ”§ æµ‹è¯•å»ºè®®

### 1. é…ç½®æµ‹è¯•

```python
from src.config.config_manager import config_manager

# æµ‹è¯•é…ç½®è¯»å–
print(f"Pool ID: {config_manager.get_pool_id()}")
print(f"Batch ID: {config_manager.get_batch_id()}")
print(f"API URL: {config_manager.get_api_endpoint('sensor_data')}")
```

### 2. APIå®¢æˆ·ç«¯æµ‹è¯•

```python
from src.services.api_client import api_client

# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ ï¼ˆå¹²è¿è¡Œæ¨¡å¼ï¼‰
api_client.dry_run = True
response = api_client.send_sensor_data(
    sensor_id=1,
    value=25.5,
    metric="temperature",
    unit="Â°C"
)
print(response)
```

### 3. æœåŠ¡ç«¯æ¥å£æµ‹è¯•

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š

```bash
# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®æ¥å£
curl -X POST http://8.216.33.92:5000/api/data/sensors \
  -H "Content-Type: application/json" \
  -d '{
    "sensor_id": 1,
    "value": 25.5,
    "metric": "temperature",
    "unit": "Â°C"
  }'
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç å¯èƒ½ä½¿ç”¨äº†æ—§çš„é…ç½®æ–¹å¼ï¼Œéœ€è¦é€æ­¥è¿ç§»
2. **é”™è¯¯å¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰APIè°ƒç”¨éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šç¡®ä¿å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
4. **æµ‹è¯•è¦†ç›–**ï¼šå»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼š
   - [ ] åœ¨æœåŠ¡ç«¯æ·»åŠ  `/api/data/cameras` æ¥å£
   - [ ] æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡ä½¿ç”¨æ–°é…ç½®å’ŒAPIå®¢æˆ·ç«¯
   - [ ] æµ‹è¯•é…ç½®ç®¡ç†å’ŒAPIå®¢æˆ·ç«¯åŠŸèƒ½

2. **çŸ­æœŸï¼ˆ1-2å¤©ï¼‰**ï¼š
   - [ ] æ”¹é€ æ‘„åƒå¤´æœåŠ¡
   - [ ] æ”¹é€ å–‚é£ŸæœºæœåŠ¡
   - [ ] æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

3. **ä¸­æœŸï¼ˆ1å‘¨ï¼‰**ï¼š
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] æ·»åŠ å•å…ƒæµ‹è¯•
   - [ ] ä¼˜åŒ–æ—¥å¿—è®°å½•
   - [ ] æ€§èƒ½ä¼˜åŒ–

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°ï¼š** 2025-01-XX



**æ—¥æœŸï¼š** 2025-01-XX

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é…ç½®ç®¡ç†æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/config/__init__.py`
- `src/config/config_manager.py`

**åŠŸèƒ½ï¼š**
- å•ä¾‹æ¨¡å¼çš„é…ç½®ç®¡ç†å™¨
- ç»Ÿä¸€è¯»å– `config/client_config.json`
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- æä¾›ä¾¿æ·çš„é…ç½®è®¿é—®æ–¹æ³•

### 2. APIå®¢æˆ·ç«¯æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/api_client.py`

**åŠŸèƒ½ï¼š**
- ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼Œé—´éš”2ç§’ï¼‰
- æ”¯æŒå¹²è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨è¡¥å……å…ƒæ•°æ®ï¼ˆbatch_id, pool_idï¼‰
- ä½¿ç”¨æœåŠ¡ç«¯æ ‡å‡†æ¥å£

**å·²å®ç°çš„æ¥å£ï¼š**
- `send_sensor_data()` - ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ 
- `send_feeder_data()` - å–‚é£Ÿæœºæ•°æ®ä¸Šä¼ 
- `send_operation_data()` - æ“ä½œæ—¥å¿—ä¸Šä¼ 
- `send_camera_image()` - æ‘„åƒå¤´å›¾åƒä¸Šä¼ 
- `send_camera_status()` - æ‘„åƒå¤´çŠ¶æ€ä¸ŠæŠ¥

### 3. ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼‰âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/sensor_data_service_v2.py`

**æ”¹è¿›ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—
- ä»é…ç½®æ–‡ä»¶è¯»å–ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨
- å®æ—¶ä¸Šä¼ æ•°æ®åˆ°æœåŠ¡ç«¯ï¼ˆä½¿ç”¨æ ‡å‡†æ¥å£ï¼‰
- è‡ªåŠ¨è¡¥å……å®Œæ•´å…ƒæ•°æ®

### 4. APIæ¥å£æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `docs/APIæ¥å£æ–‡æ¡£.md`

**å†…å®¹ï¼š**
- å®Œæ•´çš„æ¥å£è¯´æ˜
- è¯·æ±‚/å“åº”æ ¼å¼
- å­—æ®µè¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹
- é”™è¯¯å¤„ç†

### 5. æ”¹é€ è¯´æ˜æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `README_æ”¹é€ è¯´æ˜.md`

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### å®¢æˆ·ç«¯æ”¹é€ 

#### 1. æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/sensor_data_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- å°† `from src.config import get_config` æ”¹ä¸ºä½¿ç”¨æ–°çš„ `config_manager`
- æ·»åŠ æ•°æ®ä¸Šä¼ åŠŸèƒ½ï¼ˆè°ƒç”¨ `api_client.send_sensor_data()`ï¼‰
- ç¡®ä¿ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨

**å»ºè®®ï¼š** å¯ä»¥ç›´æ¥ä½¿ç”¨ `sensor_data_service_v2.py` æ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼Œæˆ–é€æ­¥è¿ç§»ã€‚

#### 2. æ”¹é€ æ‘„åƒå¤´æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/camera_controller_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `config_manager` è¯»å–æ‘„åƒå¤´é…ç½®
- ä½¿ç”¨ `api_client.send_camera_image()` ä¸Šä¼ å›¾åƒ
- è¡¥å……å®Œæ•´å…ƒæ•°æ®ï¼ˆbatch_id, pool_id, width_px, height_pxç­‰ï¼‰
- ä»é…ç½®è¯»å–æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨

#### 3. æ”¹é€ å–‚é£ŸæœºæœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/feeder_service.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_schedule_task.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_status_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- åœ¨å–‚é£Ÿæ“ä½œåè°ƒç”¨ `api_client.send_feeder_data()` è®°å½•æ•°æ®
- ä»é…ç½®è¯»å–å–‚é£Ÿæœºé…ç½®ï¼ˆdevice_id, pool_id, batch_idç­‰ï¼‰
- å®ç°æ•°æ®è®°å½•å’Œä¸Šä¼ åŠŸèƒ½

#### 4. æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

**æ–‡ä»¶ï¼š** `src/app/main.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨æ–°çš„é…ç½®ç®¡ç†æ¨¡å—
- ä½¿ç”¨æ–°çš„æœåŠ¡ç‰ˆæœ¬ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
- ç»Ÿä¸€ä»»åŠ¡æ³¨å†Œæ–¹å¼

#### 5. æ›´æ–°ä¼ æ„Ÿå™¨æ•°æ®æµå¼ä¸Šä¼ ä»»åŠ¡

**æ–‡ä»¶ï¼š** `src/tasks/sensor_data_stream_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `api_client.send_sensor_data()` æ›¿ä»£ç›´æ¥HTTPè¯·æ±‚
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—

#### 6. æ›´æ–°æ•°æ®ä¸Šä¼ è„šæœ¬

**æ–‡ä»¶ï¼š** `client/updata.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—è¯»å–è·¯å¾„é…ç½®
- ä½¿ç”¨APIå®¢æˆ·ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## âš ï¸ æœåŠ¡ç«¯éœ€è¦æ·»åŠ çš„æ¥å£

### æ‘„åƒå¤´æ•°æ®æ¥æ”¶æ¥å£

**è·¯å¾„ï¼š** `POST /api/data/cameras`

**éœ€è¦åœ¨ `japan_server/routes/data_collection_routes.py` ä¸­æ·»åŠ ï¼š**

```python
@data_collection_bp.route('/cameras', methods=['POST'])
def receive_camera_data():
    """
    æ¥æ”¶æ‘„åƒå¤´å›¾åƒæ•°æ®æ¥å£
    
    è¯·æ±‚æ–¹å¼ï¼šmultipart/form-data
    å‚æ•°ï¼š
    - file: å›¾åƒæ–‡ä»¶ï¼ˆå¿…å¡«ï¼‰
    - camera_id: æ‘„åƒå¤´IDï¼ˆå¿…å¡«ï¼‰
    - batch_id: æ‰¹æ¬¡IDï¼ˆå¯é€‰ï¼‰
    - pool_id: æ± å·ï¼ˆå¯é€‰ï¼‰
    - timestamp: Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
    - width_px: å›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - height_px: å›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - format: å›¾åƒæ ¼å¼ï¼ˆjpg/pngï¼Œå¯é€‰ï¼‰
    """
    try:
        # æ£€æŸ¥æ–‡ä»¶
        if 'file' not in request.files:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘æ–‡ä»¶å‚æ•°"
            }), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({
                "success": False,
                "error": "æ–‡ä»¶åä¸ºç©º"
            }), 400
        
        # è·å–è¡¨å•æ•°æ®
        camera_id = request.form.get('camera_id')
        if not camera_id:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘å¿…å¡«å­—æ®µ: camera_id"
            }), 400
        
        camera_id = int(camera_id)
        batch_id = request.form.get('batch_id')
        pool_id = request.form.get('pool_id')
        timestamp = request.form.get('timestamp')
        width_px = request.form.get('width_px')
        height_px = request.form.get('height_px')
        format_type = request.form.get('format', 'jpg')
        
        # TODO: ä¿å­˜æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨
        # storage_uri = save_to_storage(file, camera_id, ...)
        
        # æ—¶é—´æ ‡å‡†åŒ–
        if timestamp:
            ts_utc, ts_local = DataCleaningService.standardize_time(int(timestamp))
        else:
            ts_utc, ts_local = DataCleaningService.standardize_time(datetime.now())
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        with db_session_factory() as session:
            camera_image = CameraImage(
                camera_id=camera_id,
                batch_id=int(batch_id) if batch_id else None,
                pool_id=pool_id,
                ts_utc=ts_utc,
                ts_local=ts_local,
                storage_uri=storage_uri,  # TODO: å®é™…å­˜å‚¨URI
                width_px=int(width_px) if width_px else None,
                height_px=int(height_px) if height_px else None,
                format=format_type,
                quality_flag='ok',  # TODO: å®ç°è´¨é‡æ£€æµ‹
                checksum=checksum  # TODO: ç”Ÿæˆæ ¡éªŒå’Œ
            )
            session.add(camera_image)
            session.commit()
            
            return jsonify({
                "success": True,
                "data": {
                    "id": camera_image.id,
                    "camera_id": camera_image.camera_id,
                    "storage_uri": camera_image.storage_uri
                },
                "timestamp": int(time.time() * 1000)
            }), 201
            
    except Exception as e:
        logger.error(f"æ‘„åƒå¤´æ•°æ®æ¥æ”¶å¤±è´¥: {str(e)}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ `config/client_config.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

- [x] ç«™ç‚¹ä¿¡æ¯ï¼ˆpool_id, batch_id, location, timezoneï¼‰
- [x] ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨ï¼ˆæ¯ä¸ªè®¾å¤‡çš„å®Œæ•´é…ç½®ï¼‰
- [x] æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨
- [x] å–‚é£Ÿæœºé…ç½®
- [x] APIç«¯ç‚¹é…ç½®
- [x] ä»»åŠ¡è°ƒåº¦é…ç½®
- [x] è·¯å¾„é…ç½®
- [x] æ¨¡æ‹Ÿæ¨¡å¼é…ç½®

---

## ğŸ”§ æµ‹è¯•å»ºè®®

### 1. é…ç½®æµ‹è¯•

```python
from src.config.config_manager import config_manager

# æµ‹è¯•é…ç½®è¯»å–
print(f"Pool ID: {config_manager.get_pool_id()}")
print(f"Batch ID: {config_manager.get_batch_id()}")
print(f"API URL: {config_manager.get_api_endpoint('sensor_data')}")
```

### 2. APIå®¢æˆ·ç«¯æµ‹è¯•

```python
from src.services.api_client import api_client

# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ ï¼ˆå¹²è¿è¡Œæ¨¡å¼ï¼‰
api_client.dry_run = True
response = api_client.send_sensor_data(
    sensor_id=1,
    value=25.5,
    metric="temperature",
    unit="Â°C"
)
print(response)
```

### 3. æœåŠ¡ç«¯æ¥å£æµ‹è¯•

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š

```bash
# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®æ¥å£
curl -X POST http://8.216.33.92:5000/api/data/sensors \
  -H "Content-Type: application/json" \
  -d '{
    "sensor_id": 1,
    "value": 25.5,
    "metric": "temperature",
    "unit": "Â°C"
  }'
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç å¯èƒ½ä½¿ç”¨äº†æ—§çš„é…ç½®æ–¹å¼ï¼Œéœ€è¦é€æ­¥è¿ç§»
2. **é”™è¯¯å¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰APIè°ƒç”¨éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šç¡®ä¿å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
4. **æµ‹è¯•è¦†ç›–**ï¼šå»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼š
   - [ ] åœ¨æœåŠ¡ç«¯æ·»åŠ  `/api/data/cameras` æ¥å£
   - [ ] æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡ä½¿ç”¨æ–°é…ç½®å’ŒAPIå®¢æˆ·ç«¯
   - [ ] æµ‹è¯•é…ç½®ç®¡ç†å’ŒAPIå®¢æˆ·ç«¯åŠŸèƒ½

2. **çŸ­æœŸï¼ˆ1-2å¤©ï¼‰**ï¼š
   - [ ] æ”¹é€ æ‘„åƒå¤´æœåŠ¡
   - [ ] æ”¹é€ å–‚é£ŸæœºæœåŠ¡
   - [ ] æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

3. **ä¸­æœŸï¼ˆ1å‘¨ï¼‰**ï¼š
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] æ·»åŠ å•å…ƒæµ‹è¯•
   - [ ] ä¼˜åŒ–æ—¥å¿—è®°å½•
   - [ ] æ€§èƒ½ä¼˜åŒ–

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°ï¼š** 2025-01-XX




**æ—¥æœŸï¼š** 2025-01-XX

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é…ç½®ç®¡ç†æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/config/__init__.py`
- `src/config/config_manager.py`

**åŠŸèƒ½ï¼š**
- å•ä¾‹æ¨¡å¼çš„é…ç½®ç®¡ç†å™¨
- ç»Ÿä¸€è¯»å– `config/client_config.json`
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- æä¾›ä¾¿æ·çš„é…ç½®è®¿é—®æ–¹æ³•

### 2. APIå®¢æˆ·ç«¯æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/api_client.py`

**åŠŸèƒ½ï¼š**
- ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼Œé—´éš”2ç§’ï¼‰
- æ”¯æŒå¹²è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨è¡¥å……å…ƒæ•°æ®ï¼ˆbatch_id, pool_idï¼‰
- ä½¿ç”¨æœåŠ¡ç«¯æ ‡å‡†æ¥å£

**å·²å®ç°çš„æ¥å£ï¼š**
- `send_sensor_data()` - ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ 
- `send_feeder_data()` - å–‚é£Ÿæœºæ•°æ®ä¸Šä¼ 
- `send_operation_data()` - æ“ä½œæ—¥å¿—ä¸Šä¼ 
- `send_camera_image()` - æ‘„åƒå¤´å›¾åƒä¸Šä¼ 
- `send_camera_status()` - æ‘„åƒå¤´çŠ¶æ€ä¸ŠæŠ¥

### 3. ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼‰âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/sensor_data_service_v2.py`

**æ”¹è¿›ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—
- ä»é…ç½®æ–‡ä»¶è¯»å–ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨
- å®æ—¶ä¸Šä¼ æ•°æ®åˆ°æœåŠ¡ç«¯ï¼ˆä½¿ç”¨æ ‡å‡†æ¥å£ï¼‰
- è‡ªåŠ¨è¡¥å……å®Œæ•´å…ƒæ•°æ®

### 4. APIæ¥å£æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `docs/APIæ¥å£æ–‡æ¡£.md`

**å†…å®¹ï¼š**
- å®Œæ•´çš„æ¥å£è¯´æ˜
- è¯·æ±‚/å“åº”æ ¼å¼
- å­—æ®µè¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹
- é”™è¯¯å¤„ç†

### 5. æ”¹é€ è¯´æ˜æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `README_æ”¹é€ è¯´æ˜.md`

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### å®¢æˆ·ç«¯æ”¹é€ 

#### 1. æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/sensor_data_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- å°† `from src.config import get_config` æ”¹ä¸ºä½¿ç”¨æ–°çš„ `config_manager`
- æ·»åŠ æ•°æ®ä¸Šä¼ åŠŸèƒ½ï¼ˆè°ƒç”¨ `api_client.send_sensor_data()`ï¼‰
- ç¡®ä¿ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨

**å»ºè®®ï¼š** å¯ä»¥ç›´æ¥ä½¿ç”¨ `sensor_data_service_v2.py` æ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼Œæˆ–é€æ­¥è¿ç§»ã€‚

#### 2. æ”¹é€ æ‘„åƒå¤´æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/camera_controller_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `config_manager` è¯»å–æ‘„åƒå¤´é…ç½®
- ä½¿ç”¨ `api_client.send_camera_image()` ä¸Šä¼ å›¾åƒ
- è¡¥å……å®Œæ•´å…ƒæ•°æ®ï¼ˆbatch_id, pool_id, width_px, height_pxç­‰ï¼‰
- ä»é…ç½®è¯»å–æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨

#### 3. æ”¹é€ å–‚é£ŸæœºæœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/feeder_service.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_schedule_task.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_status_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- åœ¨å–‚é£Ÿæ“ä½œåè°ƒç”¨ `api_client.send_feeder_data()` è®°å½•æ•°æ®
- ä»é…ç½®è¯»å–å–‚é£Ÿæœºé…ç½®ï¼ˆdevice_id, pool_id, batch_idç­‰ï¼‰
- å®ç°æ•°æ®è®°å½•å’Œä¸Šä¼ åŠŸèƒ½

#### 4. æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

**æ–‡ä»¶ï¼š** `src/app/main.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨æ–°çš„é…ç½®ç®¡ç†æ¨¡å—
- ä½¿ç”¨æ–°çš„æœåŠ¡ç‰ˆæœ¬ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
- ç»Ÿä¸€ä»»åŠ¡æ³¨å†Œæ–¹å¼

#### 5. æ›´æ–°ä¼ æ„Ÿå™¨æ•°æ®æµå¼ä¸Šä¼ ä»»åŠ¡

**æ–‡ä»¶ï¼š** `src/tasks/sensor_data_stream_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `api_client.send_sensor_data()` æ›¿ä»£ç›´æ¥HTTPè¯·æ±‚
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—

#### 6. æ›´æ–°æ•°æ®ä¸Šä¼ è„šæœ¬

**æ–‡ä»¶ï¼š** `client/updata.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—è¯»å–è·¯å¾„é…ç½®
- ä½¿ç”¨APIå®¢æˆ·ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## âš ï¸ æœåŠ¡ç«¯éœ€è¦æ·»åŠ çš„æ¥å£

### æ‘„åƒå¤´æ•°æ®æ¥æ”¶æ¥å£

**è·¯å¾„ï¼š** `POST /api/data/cameras`

**éœ€è¦åœ¨ `japan_server/routes/data_collection_routes.py` ä¸­æ·»åŠ ï¼š**

```python
@data_collection_bp.route('/cameras', methods=['POST'])
def receive_camera_data():
    """
    æ¥æ”¶æ‘„åƒå¤´å›¾åƒæ•°æ®æ¥å£
    
    è¯·æ±‚æ–¹å¼ï¼šmultipart/form-data
    å‚æ•°ï¼š
    - file: å›¾åƒæ–‡ä»¶ï¼ˆå¿…å¡«ï¼‰
    - camera_id: æ‘„åƒå¤´IDï¼ˆå¿…å¡«ï¼‰
    - batch_id: æ‰¹æ¬¡IDï¼ˆå¯é€‰ï¼‰
    - pool_id: æ± å·ï¼ˆå¯é€‰ï¼‰
    - timestamp: Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
    - width_px: å›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - height_px: å›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - format: å›¾åƒæ ¼å¼ï¼ˆjpg/pngï¼Œå¯é€‰ï¼‰
    """
    try:
        # æ£€æŸ¥æ–‡ä»¶
        if 'file' not in request.files:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘æ–‡ä»¶å‚æ•°"
            }), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({
                "success": False,
                "error": "æ–‡ä»¶åä¸ºç©º"
            }), 400
        
        # è·å–è¡¨å•æ•°æ®
        camera_id = request.form.get('camera_id')
        if not camera_id:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘å¿…å¡«å­—æ®µ: camera_id"
            }), 400
        
        camera_id = int(camera_id)
        batch_id = request.form.get('batch_id')
        pool_id = request.form.get('pool_id')
        timestamp = request.form.get('timestamp')
        width_px = request.form.get('width_px')
        height_px = request.form.get('height_px')
        format_type = request.form.get('format', 'jpg')
        
        # TODO: ä¿å­˜æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨
        # storage_uri = save_to_storage(file, camera_id, ...)
        
        # æ—¶é—´æ ‡å‡†åŒ–
        if timestamp:
            ts_utc, ts_local = DataCleaningService.standardize_time(int(timestamp))
        else:
            ts_utc, ts_local = DataCleaningService.standardize_time(datetime.now())
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        with db_session_factory() as session:
            camera_image = CameraImage(
                camera_id=camera_id,
                batch_id=int(batch_id) if batch_id else None,
                pool_id=pool_id,
                ts_utc=ts_utc,
                ts_local=ts_local,
                storage_uri=storage_uri,  # TODO: å®é™…å­˜å‚¨URI
                width_px=int(width_px) if width_px else None,
                height_px=int(height_px) if height_px else None,
                format=format_type,
                quality_flag='ok',  # TODO: å®ç°è´¨é‡æ£€æµ‹
                checksum=checksum  # TODO: ç”Ÿæˆæ ¡éªŒå’Œ
            )
            session.add(camera_image)
            session.commit()
            
            return jsonify({
                "success": True,
                "data": {
                    "id": camera_image.id,
                    "camera_id": camera_image.camera_id,
                    "storage_uri": camera_image.storage_uri
                },
                "timestamp": int(time.time() * 1000)
            }), 201
            
    except Exception as e:
        logger.error(f"æ‘„åƒå¤´æ•°æ®æ¥æ”¶å¤±è´¥: {str(e)}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ `config/client_config.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

- [x] ç«™ç‚¹ä¿¡æ¯ï¼ˆpool_id, batch_id, location, timezoneï¼‰
- [x] ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨ï¼ˆæ¯ä¸ªè®¾å¤‡çš„å®Œæ•´é…ç½®ï¼‰
- [x] æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨
- [x] å–‚é£Ÿæœºé…ç½®
- [x] APIç«¯ç‚¹é…ç½®
- [x] ä»»åŠ¡è°ƒåº¦é…ç½®
- [x] è·¯å¾„é…ç½®
- [x] æ¨¡æ‹Ÿæ¨¡å¼é…ç½®

---

## ğŸ”§ æµ‹è¯•å»ºè®®

### 1. é…ç½®æµ‹è¯•

```python
from src.config.config_manager import config_manager

# æµ‹è¯•é…ç½®è¯»å–
print(f"Pool ID: {config_manager.get_pool_id()}")
print(f"Batch ID: {config_manager.get_batch_id()}")
print(f"API URL: {config_manager.get_api_endpoint('sensor_data')}")
```

### 2. APIå®¢æˆ·ç«¯æµ‹è¯•

```python
from src.services.api_client import api_client

# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ ï¼ˆå¹²è¿è¡Œæ¨¡å¼ï¼‰
api_client.dry_run = True
response = api_client.send_sensor_data(
    sensor_id=1,
    value=25.5,
    metric="temperature",
    unit="Â°C"
)
print(response)
```

### 3. æœåŠ¡ç«¯æ¥å£æµ‹è¯•

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š

```bash
# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®æ¥å£
curl -X POST http://8.216.33.92:5000/api/data/sensors \
  -H "Content-Type: application/json" \
  -d '{
    "sensor_id": 1,
    "value": 25.5,
    "metric": "temperature",
    "unit": "Â°C"
  }'
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç å¯èƒ½ä½¿ç”¨äº†æ—§çš„é…ç½®æ–¹å¼ï¼Œéœ€è¦é€æ­¥è¿ç§»
2. **é”™è¯¯å¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰APIè°ƒç”¨éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šç¡®ä¿å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
4. **æµ‹è¯•è¦†ç›–**ï¼šå»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼š
   - [ ] åœ¨æœåŠ¡ç«¯æ·»åŠ  `/api/data/cameras` æ¥å£
   - [ ] æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡ä½¿ç”¨æ–°é…ç½®å’ŒAPIå®¢æˆ·ç«¯
   - [ ] æµ‹è¯•é…ç½®ç®¡ç†å’ŒAPIå®¢æˆ·ç«¯åŠŸèƒ½

2. **çŸ­æœŸï¼ˆ1-2å¤©ï¼‰**ï¼š
   - [ ] æ”¹é€ æ‘„åƒå¤´æœåŠ¡
   - [ ] æ”¹é€ å–‚é£ŸæœºæœåŠ¡
   - [ ] æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

3. **ä¸­æœŸï¼ˆ1å‘¨ï¼‰**ï¼š
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] æ·»åŠ å•å…ƒæµ‹è¯•
   - [ ] ä¼˜åŒ–æ—¥å¿—è®°å½•
   - [ ] æ€§èƒ½ä¼˜åŒ–

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°ï¼š** 2025-01-XX



**æ—¥æœŸï¼š** 2025-01-XX

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é…ç½®ç®¡ç†æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/config/__init__.py`
- `src/config/config_manager.py`

**åŠŸèƒ½ï¼š**
- å•ä¾‹æ¨¡å¼çš„é…ç½®ç®¡ç†å™¨
- ç»Ÿä¸€è¯»å– `config/client_config.json`
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- æä¾›ä¾¿æ·çš„é…ç½®è®¿é—®æ–¹æ³•

### 2. APIå®¢æˆ·ç«¯æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/api_client.py`

**åŠŸèƒ½ï¼š**
- ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼Œé—´éš”2ç§’ï¼‰
- æ”¯æŒå¹²è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨è¡¥å……å…ƒæ•°æ®ï¼ˆbatch_id, pool_idï¼‰
- ä½¿ç”¨æœåŠ¡ç«¯æ ‡å‡†æ¥å£

**å·²å®ç°çš„æ¥å£ï¼š**
- `send_sensor_data()` - ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ 
- `send_feeder_data()` - å–‚é£Ÿæœºæ•°æ®ä¸Šä¼ 
- `send_operation_data()` - æ“ä½œæ—¥å¿—ä¸Šä¼ 
- `send_camera_image()` - æ‘„åƒå¤´å›¾åƒä¸Šä¼ 
- `send_camera_status()` - æ‘„åƒå¤´çŠ¶æ€ä¸ŠæŠ¥

### 3. ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼‰âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/sensor_data_service_v2.py`

**æ”¹è¿›ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—
- ä»é…ç½®æ–‡ä»¶è¯»å–ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨
- å®æ—¶ä¸Šä¼ æ•°æ®åˆ°æœåŠ¡ç«¯ï¼ˆä½¿ç”¨æ ‡å‡†æ¥å£ï¼‰
- è‡ªåŠ¨è¡¥å……å®Œæ•´å…ƒæ•°æ®

### 4. APIæ¥å£æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `docs/APIæ¥å£æ–‡æ¡£.md`

**å†…å®¹ï¼š**
- å®Œæ•´çš„æ¥å£è¯´æ˜
- è¯·æ±‚/å“åº”æ ¼å¼
- å­—æ®µè¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹
- é”™è¯¯å¤„ç†

### 5. æ”¹é€ è¯´æ˜æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `README_æ”¹é€ è¯´æ˜.md`

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### å®¢æˆ·ç«¯æ”¹é€ 

#### 1. æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/sensor_data_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- å°† `from src.config import get_config` æ”¹ä¸ºä½¿ç”¨æ–°çš„ `config_manager`
- æ·»åŠ æ•°æ®ä¸Šä¼ åŠŸèƒ½ï¼ˆè°ƒç”¨ `api_client.send_sensor_data()`ï¼‰
- ç¡®ä¿ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨

**å»ºè®®ï¼š** å¯ä»¥ç›´æ¥ä½¿ç”¨ `sensor_data_service_v2.py` æ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼Œæˆ–é€æ­¥è¿ç§»ã€‚

#### 2. æ”¹é€ æ‘„åƒå¤´æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/camera_controller_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `config_manager` è¯»å–æ‘„åƒå¤´é…ç½®
- ä½¿ç”¨ `api_client.send_camera_image()` ä¸Šä¼ å›¾åƒ
- è¡¥å……å®Œæ•´å…ƒæ•°æ®ï¼ˆbatch_id, pool_id, width_px, height_pxç­‰ï¼‰
- ä»é…ç½®è¯»å–æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨

#### 3. æ”¹é€ å–‚é£ŸæœºæœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/feeder_service.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_schedule_task.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_status_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- åœ¨å–‚é£Ÿæ“ä½œåè°ƒç”¨ `api_client.send_feeder_data()` è®°å½•æ•°æ®
- ä»é…ç½®è¯»å–å–‚é£Ÿæœºé…ç½®ï¼ˆdevice_id, pool_id, batch_idç­‰ï¼‰
- å®ç°æ•°æ®è®°å½•å’Œä¸Šä¼ åŠŸèƒ½

#### 4. æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

**æ–‡ä»¶ï¼š** `src/app/main.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨æ–°çš„é…ç½®ç®¡ç†æ¨¡å—
- ä½¿ç”¨æ–°çš„æœåŠ¡ç‰ˆæœ¬ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
- ç»Ÿä¸€ä»»åŠ¡æ³¨å†Œæ–¹å¼

#### 5. æ›´æ–°ä¼ æ„Ÿå™¨æ•°æ®æµå¼ä¸Šä¼ ä»»åŠ¡

**æ–‡ä»¶ï¼š** `src/tasks/sensor_data_stream_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `api_client.send_sensor_data()` æ›¿ä»£ç›´æ¥HTTPè¯·æ±‚
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—

#### 6. æ›´æ–°æ•°æ®ä¸Šä¼ è„šæœ¬

**æ–‡ä»¶ï¼š** `client/updata.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—è¯»å–è·¯å¾„é…ç½®
- ä½¿ç”¨APIå®¢æˆ·ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## âš ï¸ æœåŠ¡ç«¯éœ€è¦æ·»åŠ çš„æ¥å£

### æ‘„åƒå¤´æ•°æ®æ¥æ”¶æ¥å£

**è·¯å¾„ï¼š** `POST /api/data/cameras`

**éœ€è¦åœ¨ `japan_server/routes/data_collection_routes.py` ä¸­æ·»åŠ ï¼š**

```python
@data_collection_bp.route('/cameras', methods=['POST'])
def receive_camera_data():
    """
    æ¥æ”¶æ‘„åƒå¤´å›¾åƒæ•°æ®æ¥å£
    
    è¯·æ±‚æ–¹å¼ï¼šmultipart/form-data
    å‚æ•°ï¼š
    - file: å›¾åƒæ–‡ä»¶ï¼ˆå¿…å¡«ï¼‰
    - camera_id: æ‘„åƒå¤´IDï¼ˆå¿…å¡«ï¼‰
    - batch_id: æ‰¹æ¬¡IDï¼ˆå¯é€‰ï¼‰
    - pool_id: æ± å·ï¼ˆå¯é€‰ï¼‰
    - timestamp: Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
    - width_px: å›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - height_px: å›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - format: å›¾åƒæ ¼å¼ï¼ˆjpg/pngï¼Œå¯é€‰ï¼‰
    """
    try:
        # æ£€æŸ¥æ–‡ä»¶
        if 'file' not in request.files:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘æ–‡ä»¶å‚æ•°"
            }), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({
                "success": False,
                "error": "æ–‡ä»¶åä¸ºç©º"
            }), 400
        
        # è·å–è¡¨å•æ•°æ®
        camera_id = request.form.get('camera_id')
        if not camera_id:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘å¿…å¡«å­—æ®µ: camera_id"
            }), 400
        
        camera_id = int(camera_id)
        batch_id = request.form.get('batch_id')
        pool_id = request.form.get('pool_id')
        timestamp = request.form.get('timestamp')
        width_px = request.form.get('width_px')
        height_px = request.form.get('height_px')
        format_type = request.form.get('format', 'jpg')
        
        # TODO: ä¿å­˜æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨
        # storage_uri = save_to_storage(file, camera_id, ...)
        
        # æ—¶é—´æ ‡å‡†åŒ–
        if timestamp:
            ts_utc, ts_local = DataCleaningService.standardize_time(int(timestamp))
        else:
            ts_utc, ts_local = DataCleaningService.standardize_time(datetime.now())
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        with db_session_factory() as session:
            camera_image = CameraImage(
                camera_id=camera_id,
                batch_id=int(batch_id) if batch_id else None,
                pool_id=pool_id,
                ts_utc=ts_utc,
                ts_local=ts_local,
                storage_uri=storage_uri,  # TODO: å®é™…å­˜å‚¨URI
                width_px=int(width_px) if width_px else None,
                height_px=int(height_px) if height_px else None,
                format=format_type,
                quality_flag='ok',  # TODO: å®ç°è´¨é‡æ£€æµ‹
                checksum=checksum  # TODO: ç”Ÿæˆæ ¡éªŒå’Œ
            )
            session.add(camera_image)
            session.commit()
            
            return jsonify({
                "success": True,
                "data": {
                    "id": camera_image.id,
                    "camera_id": camera_image.camera_id,
                    "storage_uri": camera_image.storage_uri
                },
                "timestamp": int(time.time() * 1000)
            }), 201
            
    except Exception as e:
        logger.error(f"æ‘„åƒå¤´æ•°æ®æ¥æ”¶å¤±è´¥: {str(e)}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ `config/client_config.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

- [x] ç«™ç‚¹ä¿¡æ¯ï¼ˆpool_id, batch_id, location, timezoneï¼‰
- [x] ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨ï¼ˆæ¯ä¸ªè®¾å¤‡çš„å®Œæ•´é…ç½®ï¼‰
- [x] æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨
- [x] å–‚é£Ÿæœºé…ç½®
- [x] APIç«¯ç‚¹é…ç½®
- [x] ä»»åŠ¡è°ƒåº¦é…ç½®
- [x] è·¯å¾„é…ç½®
- [x] æ¨¡æ‹Ÿæ¨¡å¼é…ç½®

---

## ğŸ”§ æµ‹è¯•å»ºè®®

### 1. é…ç½®æµ‹è¯•

```python
from src.config.config_manager import config_manager

# æµ‹è¯•é…ç½®è¯»å–
print(f"Pool ID: {config_manager.get_pool_id()}")
print(f"Batch ID: {config_manager.get_batch_id()}")
print(f"API URL: {config_manager.get_api_endpoint('sensor_data')}")
```

### 2. APIå®¢æˆ·ç«¯æµ‹è¯•

```python
from src.services.api_client import api_client

# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ ï¼ˆå¹²è¿è¡Œæ¨¡å¼ï¼‰
api_client.dry_run = True
response = api_client.send_sensor_data(
    sensor_id=1,
    value=25.5,
    metric="temperature",
    unit="Â°C"
)
print(response)
```

### 3. æœåŠ¡ç«¯æ¥å£æµ‹è¯•

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š

```bash
# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®æ¥å£
curl -X POST http://8.216.33.92:5000/api/data/sensors \
  -H "Content-Type: application/json" \
  -d '{
    "sensor_id": 1,
    "value": 25.5,
    "metric": "temperature",
    "unit": "Â°C"
  }'
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç å¯èƒ½ä½¿ç”¨äº†æ—§çš„é…ç½®æ–¹å¼ï¼Œéœ€è¦é€æ­¥è¿ç§»
2. **é”™è¯¯å¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰APIè°ƒç”¨éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šç¡®ä¿å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
4. **æµ‹è¯•è¦†ç›–**ï¼šå»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼š
   - [ ] åœ¨æœåŠ¡ç«¯æ·»åŠ  `/api/data/cameras` æ¥å£
   - [ ] æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡ä½¿ç”¨æ–°é…ç½®å’ŒAPIå®¢æˆ·ç«¯
   - [ ] æµ‹è¯•é…ç½®ç®¡ç†å’ŒAPIå®¢æˆ·ç«¯åŠŸèƒ½

2. **çŸ­æœŸï¼ˆ1-2å¤©ï¼‰**ï¼š
   - [ ] æ”¹é€ æ‘„åƒå¤´æœåŠ¡
   - [ ] æ”¹é€ å–‚é£ŸæœºæœåŠ¡
   - [ ] æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

3. **ä¸­æœŸï¼ˆ1å‘¨ï¼‰**ï¼š
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] æ·»åŠ å•å…ƒæµ‹è¯•
   - [ ] ä¼˜åŒ–æ—¥å¿—è®°å½•
   - [ ] æ€§èƒ½ä¼˜åŒ–

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°ï¼š** 2025-01-XX




**æ—¥æœŸï¼š** 2025-01-XX

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é…ç½®ç®¡ç†æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/config/__init__.py`
- `src/config/config_manager.py`

**åŠŸèƒ½ï¼š**
- å•ä¾‹æ¨¡å¼çš„é…ç½®ç®¡ç†å™¨
- ç»Ÿä¸€è¯»å– `config/client_config.json`
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- æä¾›ä¾¿æ·çš„é…ç½®è®¿é—®æ–¹æ³•

### 2. APIå®¢æˆ·ç«¯æ¨¡å— âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/api_client.py`

**åŠŸèƒ½ï¼š**
- ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼Œé—´éš”2ç§’ï¼‰
- æ”¯æŒå¹²è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨è¡¥å……å…ƒæ•°æ®ï¼ˆbatch_id, pool_idï¼‰
- ä½¿ç”¨æœåŠ¡ç«¯æ ‡å‡†æ¥å£

**å·²å®ç°çš„æ¥å£ï¼š**
- `send_sensor_data()` - ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ 
- `send_feeder_data()` - å–‚é£Ÿæœºæ•°æ®ä¸Šä¼ 
- `send_operation_data()` - æ“ä½œæ—¥å¿—ä¸Šä¼ 
- `send_camera_image()` - æ‘„åƒå¤´å›¾åƒä¸Šä¼ 
- `send_camera_status()` - æ‘„åƒå¤´çŠ¶æ€ä¸ŠæŠ¥

### 3. ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡ï¼ˆæ–°ç‰ˆæœ¬ï¼‰âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `src/services/sensor_data_service_v2.py`

**æ”¹è¿›ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—
- ä»é…ç½®æ–‡ä»¶è¯»å–ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨
- å®æ—¶ä¸Šä¼ æ•°æ®åˆ°æœåŠ¡ç«¯ï¼ˆä½¿ç”¨æ ‡å‡†æ¥å£ï¼‰
- è‡ªåŠ¨è¡¥å……å®Œæ•´å…ƒæ•°æ®

### 4. APIæ¥å£æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `docs/APIæ¥å£æ–‡æ¡£.md`

**å†…å®¹ï¼š**
- å®Œæ•´çš„æ¥å£è¯´æ˜
- è¯·æ±‚/å“åº”æ ¼å¼
- å­—æ®µè¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹
- é”™è¯¯å¤„ç†

### 5. æ”¹é€ è¯´æ˜æ–‡æ¡£ âœ…

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `README_æ”¹é€ è¯´æ˜.md`

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### å®¢æˆ·ç«¯æ”¹é€ 

#### 1. æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/sensor_data_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- å°† `from src.config import get_config` æ”¹ä¸ºä½¿ç”¨æ–°çš„ `config_manager`
- æ·»åŠ æ•°æ®ä¸Šä¼ åŠŸèƒ½ï¼ˆè°ƒç”¨ `api_client.send_sensor_data()`ï¼‰
- ç¡®ä¿ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨

**å»ºè®®ï¼š** å¯ä»¥ç›´æ¥ä½¿ç”¨ `sensor_data_service_v2.py` æ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼Œæˆ–é€æ­¥è¿ç§»ã€‚

#### 2. æ”¹é€ æ‘„åƒå¤´æœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/camera_controller_service.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `config_manager` è¯»å–æ‘„åƒå¤´é…ç½®
- ä½¿ç”¨ `api_client.send_camera_image()` ä¸Šä¼ å›¾åƒ
- è¡¥å……å®Œæ•´å…ƒæ•°æ®ï¼ˆbatch_id, pool_id, width_px, height_pxç­‰ï¼‰
- ä»é…ç½®è¯»å–æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨

#### 3. æ”¹é€ å–‚é£ŸæœºæœåŠ¡

**æ–‡ä»¶ï¼š** `src/services/feeder_service.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_schedule_task.py`  
**æ–‡ä»¶ï¼š** `src/tasks/feed_device_status_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- åœ¨å–‚é£Ÿæ“ä½œåè°ƒç”¨ `api_client.send_feeder_data()` è®°å½•æ•°æ®
- ä»é…ç½®è¯»å–å–‚é£Ÿæœºé…ç½®ï¼ˆdevice_id, pool_id, batch_idç­‰ï¼‰
- å®ç°æ•°æ®è®°å½•å’Œä¸Šä¼ åŠŸèƒ½

#### 4. æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

**æ–‡ä»¶ï¼š** `src/app/main.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨æ–°çš„é…ç½®ç®¡ç†æ¨¡å—
- ä½¿ç”¨æ–°çš„æœåŠ¡ç‰ˆæœ¬ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
- ç»Ÿä¸€ä»»åŠ¡æ³¨å†Œæ–¹å¼

#### 5. æ›´æ–°ä¼ æ„Ÿå™¨æ•°æ®æµå¼ä¸Šä¼ ä»»åŠ¡

**æ–‡ä»¶ï¼š** `src/tasks/sensor_data_stream_task.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨ `api_client.send_sensor_data()` æ›¿ä»£ç›´æ¥HTTPè¯·æ±‚
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—

#### 6. æ›´æ–°æ•°æ®ä¸Šä¼ è„šæœ¬

**æ–‡ä»¶ï¼š** `client/updata.py`

**éœ€è¦ä¿®æ”¹ï¼š**
- ä½¿ç”¨é…ç½®ç®¡ç†æ¨¡å—è¯»å–è·¯å¾„é…ç½®
- ä½¿ç”¨APIå®¢æˆ·ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## âš ï¸ æœåŠ¡ç«¯éœ€è¦æ·»åŠ çš„æ¥å£

### æ‘„åƒå¤´æ•°æ®æ¥æ”¶æ¥å£

**è·¯å¾„ï¼š** `POST /api/data/cameras`

**éœ€è¦åœ¨ `japan_server/routes/data_collection_routes.py` ä¸­æ·»åŠ ï¼š**

```python
@data_collection_bp.route('/cameras', methods=['POST'])
def receive_camera_data():
    """
    æ¥æ”¶æ‘„åƒå¤´å›¾åƒæ•°æ®æ¥å£
    
    è¯·æ±‚æ–¹å¼ï¼šmultipart/form-data
    å‚æ•°ï¼š
    - file: å›¾åƒæ–‡ä»¶ï¼ˆå¿…å¡«ï¼‰
    - camera_id: æ‘„åƒå¤´IDï¼ˆå¿…å¡«ï¼‰
    - batch_id: æ‰¹æ¬¡IDï¼ˆå¯é€‰ï¼‰
    - pool_id: æ± å·ï¼ˆå¯é€‰ï¼‰
    - timestamp: Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
    - width_px: å›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - height_px: å›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼Œå¯é€‰ï¼‰
    - format: å›¾åƒæ ¼å¼ï¼ˆjpg/pngï¼Œå¯é€‰ï¼‰
    """
    try:
        # æ£€æŸ¥æ–‡ä»¶
        if 'file' not in request.files:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘æ–‡ä»¶å‚æ•°"
            }), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({
                "success": False,
                "error": "æ–‡ä»¶åä¸ºç©º"
            }), 400
        
        # è·å–è¡¨å•æ•°æ®
        camera_id = request.form.get('camera_id')
        if not camera_id:
            return jsonify({
                "success": False,
                "error": "ç¼ºå°‘å¿…å¡«å­—æ®µ: camera_id"
            }), 400
        
        camera_id = int(camera_id)
        batch_id = request.form.get('batch_id')
        pool_id = request.form.get('pool_id')
        timestamp = request.form.get('timestamp')
        width_px = request.form.get('width_px')
        height_px = request.form.get('height_px')
        format_type = request.form.get('format', 'jpg')
        
        # TODO: ä¿å­˜æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨
        # storage_uri = save_to_storage(file, camera_id, ...)
        
        # æ—¶é—´æ ‡å‡†åŒ–
        if timestamp:
            ts_utc, ts_local = DataCleaningService.standardize_time(int(timestamp))
        else:
            ts_utc, ts_local = DataCleaningService.standardize_time(datetime.now())
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        with db_session_factory() as session:
            camera_image = CameraImage(
                camera_id=camera_id,
                batch_id=int(batch_id) if batch_id else None,
                pool_id=pool_id,
                ts_utc=ts_utc,
                ts_local=ts_local,
                storage_uri=storage_uri,  # TODO: å®é™…å­˜å‚¨URI
                width_px=int(width_px) if width_px else None,
                height_px=int(height_px) if height_px else None,
                format=format_type,
                quality_flag='ok',  # TODO: å®ç°è´¨é‡æ£€æµ‹
                checksum=checksum  # TODO: ç”Ÿæˆæ ¡éªŒå’Œ
            )
            session.add(camera_image)
            session.commit()
            
            return jsonify({
                "success": True,
                "data": {
                    "id": camera_image.id,
                    "camera_id": camera_image.camera_id,
                    "storage_uri": camera_image.storage_uri
                },
                "timestamp": int(time.time() * 1000)
            }), 201
            
    except Exception as e:
        logger.error(f"æ‘„åƒå¤´æ•°æ®æ¥æ”¶å¤±è´¥: {str(e)}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ `config/client_config.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

- [x] ç«™ç‚¹ä¿¡æ¯ï¼ˆpool_id, batch_id, location, timezoneï¼‰
- [x] ä¼ æ„Ÿå™¨è®¾å¤‡åˆ—è¡¨ï¼ˆæ¯ä¸ªè®¾å¤‡çš„å®Œæ•´é…ç½®ï¼‰
- [x] æ‘„åƒå¤´è®¾å¤‡åˆ—è¡¨
- [x] å–‚é£Ÿæœºé…ç½®
- [x] APIç«¯ç‚¹é…ç½®
- [x] ä»»åŠ¡è°ƒåº¦é…ç½®
- [x] è·¯å¾„é…ç½®
- [x] æ¨¡æ‹Ÿæ¨¡å¼é…ç½®

---

## ğŸ”§ æµ‹è¯•å»ºè®®

### 1. é…ç½®æµ‹è¯•

```python
from src.config.config_manager import config_manager

# æµ‹è¯•é…ç½®è¯»å–
print(f"Pool ID: {config_manager.get_pool_id()}")
print(f"Batch ID: {config_manager.get_batch_id()}")
print(f"API URL: {config_manager.get_api_endpoint('sensor_data')}")
```

### 2. APIå®¢æˆ·ç«¯æµ‹è¯•

```python
from src.services.api_client import api_client

# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®ä¸Šä¼ ï¼ˆå¹²è¿è¡Œæ¨¡å¼ï¼‰
api_client.dry_run = True
response = api_client.send_sensor_data(
    sensor_id=1,
    value=25.5,
    metric="temperature",
    unit="Â°C"
)
print(response)
```

### 3. æœåŠ¡ç«¯æ¥å£æµ‹è¯•

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š

```bash
# æµ‹è¯•ä¼ æ„Ÿå™¨æ•°æ®æ¥å£
curl -X POST http://8.216.33.92:5000/api/data/sensors \
  -H "Content-Type: application/json" \
  -d '{
    "sensor_id": 1,
    "value": 25.5,
    "metric": "temperature",
    "unit": "Â°C"
  }'
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç å¯èƒ½ä½¿ç”¨äº†æ—§çš„é…ç½®æ–¹å¼ï¼Œéœ€è¦é€æ­¥è¿ç§»
2. **é”™è¯¯å¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰APIè°ƒç”¨éƒ½æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šç¡®ä¿å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
4. **æµ‹è¯•è¦†ç›–**ï¼šå»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼š
   - [ ] åœ¨æœåŠ¡ç«¯æ·»åŠ  `/api/data/cameras` æ¥å£
   - [ ] æ›´æ–°ç°æœ‰ä¼ æ„Ÿå™¨æœåŠ¡ä½¿ç”¨æ–°é…ç½®å’ŒAPIå®¢æˆ·ç«¯
   - [ ] æµ‹è¯•é…ç½®ç®¡ç†å’ŒAPIå®¢æˆ·ç«¯åŠŸèƒ½

2. **çŸ­æœŸï¼ˆ1-2å¤©ï¼‰**ï¼š
   - [ ] æ”¹é€ æ‘„åƒå¤´æœåŠ¡
   - [ ] æ”¹é€ å–‚é£ŸæœºæœåŠ¡
   - [ ] æ›´æ–°ä¸»å…¥å£æ–‡ä»¶

3. **ä¸­æœŸï¼ˆ1å‘¨ï¼‰**ï¼š
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] æ·»åŠ å•å…ƒæµ‹è¯•
   - [ ] ä¼˜åŒ–æ—¥å¿—è®°å½•
   - [ ] æ€§èƒ½ä¼˜åŒ–

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°ï¼š** 2025-01-XX


